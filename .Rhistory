i
hc.cut <- hcut(bd2, k = 2, hc_method = "single", hc_metric = "euclidean", stand = TRUE)
library(readr)
bd <- read_csv("tinto.csv")
View(bd)
library(factoextra)
library(readxl)
library(tibble)
library(faraway)
library(visdat)
library(arsenal)
library(ggplot2)
library(GGally)
library(ggeffects)
library(rgl)
library(pROC)
library(car)
library(sjPlot)
library(performance)
library(dplyr)
library(cluster)
library(pheatmap)
library(fmsb)
# nueva bd sin esos 19 outliers
bd2 <- bd[-c(82,87,92,93,107,152,259,481,653,724,1080,1082,1236,1245,1435,1436,1475,1477,1575),]
#Matriz de distancias estandarizadas
#estandarizacion con bd sin outliers
z<-scale(bd2)
#calculamos dist
dz<-dist(z, method = "euclidean") # matriz distancias
hc.cut <- hcut(bd2, k = 2, hc_method = "single", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# centroide
hc.cut <- hcut(bd, k = 2, hc_method = "centroid", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
hc.cut <- hcut(bd, k = 2, hc_method = "complete", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
hc.cut <- hcut(bd, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
h
hc.cut <- hcut(bd2, k = 2, hc_method = "single", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
hc.cut <- hcut(bd, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# ward
hc.cut <- hcut(bd, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
#Le asignamos a cada objeto el cluster de pertenencia
bd$grupo <-cutree(hc.cut, k=2)
bd2$grupo <-cutree(hc.cut, k=2)
bd2$grupo <-cutree(hc.cut, k=2)
# centroide
hc.cut <- hcut(bd2, k = 2, hc_method = "centroid", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
hc.cut <- hcut(bd2, k = 2, hc_method = "single", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# centroide
hc.cut <- hcut(bd2, k = 2, hc_method = "centroid", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# completo
hc.cut <- hcut(bd2, k = 2, hc_method = "complete", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# ward
hc.cut <- hcut(bd2, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# ward
hc.cut <- hcut(bd2, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
# completo
hc.cut <- hcut(bd2, k = 2, hc_method = "complete", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# centroide
hc.cut <- hcut(bd2, k = 2, hc_method = "centroid", hc_metric = "euclidean", stand = TRUE)
fviz_silhouette(hc.cut, label=TRUE)
# ward k = 5
fviz_dend(c2, cex = 0.5, k = 5)
# ward
hc.cut <- hcut(bd2, k = 2, hc_method = "ward.D", hc_metric = "euclidean", stand = TRUE)
#Le asignamos a cada objeto el cluster de pertenencia
bd$grupo <-cutree(hc.cut, k=2)
bd2$grupo <-cutree(hc.cut, k=2)
c4<-hclust(dz, method = "ward.D", members = NULL)
# ward k = 5
fviz_dend(c4, cex = 0.5, k = 2)
fviz_dend(hc.cut, show_labels = TRUE, rect = TRUE)
#descriptiva por cluster
tab1 <- tableby(grupo ~ ., data=bd2)
summary(tab1, text=T)
num_vars <- sapply(bd2, is.numeric)
mat <- scale(bd2[, num_vars])
pheatmap(mat, clustering_distance_rows = "euclidean", clustering_distance_cols = "euclidean", clustering_method = "ward.D2", # podés probar otros
color = colorRampPalette(c("navy", "white", "firebrick3"))(50), main = "Heatmap de vinos por variables físico-químicas")
grafico <- fviz_cluster(hc.cut, data = bd2,
geom = "point",
ellipse.type = "convex",
palette = "jco",
ggtheme = theme_minimal())
grafico
#medias por grupo
media_grupo <- bd2 %>% group_by(grupo) %>% summarise(across(acidez_fija:calidad, mean, na.rm = TRUE))
media_grupo
#rescalar(0-1) para que todas las variables estén en misma escala
media_norm <- as.data.frame(scale(media_grupo))
rownames(media_norm) <- paste("Grupo", media_grupo$grupo)
media_norm
#preparar para radarchart
df_radar <- rbind(apply(media_norm, 2, max), apply(media_norm, 2, min), media_norm)
radarchart(df_radar, axistype = 1, pcol = 1:4, plwd = 2, plty = 1, title = "Perfiles promedio de cada grupo")
legend("topright", legend = rownames(media_norm), col = 1:4, lty = 1, lwd = 2, bty = "n")
